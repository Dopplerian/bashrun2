
# -*- shell-script -*-

############################################################

. $BASHRUN_SHARE/utils
. $BASHRUN_SHARE/globals
. $BASHRUN_SHARE/config
. $BASHRUN_SHARE/geometry
. $BASHRUN_SHARE/instance
. $BASHRUN_SHARE/registry
. $BASHRUN_SHARE/window
. $BASHRUN_SHARE/terminals
. $BASHRUN_SHARE/modes
. $BASHRUN_RCFILE

# load modes and terminals 
bashrun.configure.type "modes"
bashrun.configure.type "terminals"

############################################################

function version {
    echo "bashrun $BASHRUN_VERSION Copyright (C) 2009 Henning Bekel <h.bekel@googlemail.com>"
}

function usage {

    version
    echo "
Usage: bashrun [option]

   Options:
     -v, --version : show version information
     -h, --help    : show this message
     -d, --debug   : start bashrun in debug mode

     Available if xdotool(1) is installed:
       --show    : show bashrun window and focus it
       --hide    : hide the bashrun window
       --toggle  : toggle window visibility
       --exit    : exit bashrun
       --restart : restart bashrun
       --su cmd  : run command as root,
                   prompts for password in bashrun
       --wid     : print window id
       --wait    : wait until window is unmapped
       --debug   : toggle debug mode

       Press F1 in bashrun to list the current keyÂ§bindings.

For more information, see bashrun(1) or visit http://bashrun.sourceforge.net
"
}

function get_wid {
    
    expected=$1
    ((expected+=1))

    # wait for instance to register
    until [[ "$(bashrun.registry.length)" -eq expected ]]; do
	sleep 0.2
    done
    bashrun.registry.get_last_wid
}
